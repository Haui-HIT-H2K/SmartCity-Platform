"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5896],{8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>t});var s=r(6540);const o={},c=s.createContext(o);function i(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(c.Provider,{value:n},e.children)}},8942:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"docker","title":"Docker Deployment","description":"T\u1ed5ng quan","source":"@site/infrastructure-docs/docker.md","sourceDirName":".","slug":"/docker","permalink":"/SmartCity-Platform/infrastructure/docker","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Docker Deployment"},"sidebar":"infraSidebar","next":{"title":"Lu\u1ed3ng D\u1eef Li\u1ec7u (Data Flow)","permalink":"/SmartCity-Platform/infrastructure/intro"}}');var o=r(4848),c=r(8453);const i={sidebar_position:1,title:"Docker Deployment"},t="Docker Deployment",a={},d=[{value:"T\u1ed5ng quan",id:"t\u1ed5ng-quan",level:2},{value:"Ki\u1ebfn tr\xfac Container",id:"ki\u1ebfn-tr\xfac-container",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Y\xeau c\u1ea7u H\u1ec7 th\u1ed1ng",id:"y\xeau-c\u1ea7u-h\u1ec7-th\u1ed1ng",level:3},{value:"C\xe0i \u0111\u1eb7t Docker",id:"c\xe0i-\u0111\u1eb7t-docker",level:3},{value:"Docker Compose Configuration",id:"docker-compose-configuration",level:2},{value:"File Structure",id:"file-structure",level:3},{value:"Services Overview",id:"services-overview",level:3},{value:"Deployment",id:"deployment",level:2},{value:"Quick Start (One Command)",id:"quick-start-one-command",level:3},{value:"Step-by-Step Deployment",id:"step-by-step-deployment",level:3},{value:"Service Configuration",id:"service-configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Volume Mounting",id:"volume-mounting",level:3},{value:"Networking",id:"networking",level:3},{value:"Container Management",id:"container-management",level:2},{value:"Start/Stop Services",id:"startstop-services",level:3},{value:"Logs v\xe0 Monitoring",id:"logs-v\xe0-monitoring",level:3},{value:"Resource Management",id:"resource-management",level:3},{value:"Health Checks",id:"health-checks",level:3},{value:"Data Management",id:"data-management",level:2},{value:"Backup",id:"backup",level:3},{value:"Restore",id:"restore",level:3},{value:"Reset All Data",id:"reset-all-data",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Debug Mode",id:"debug-mode",level:3},{value:"Production Deployment",id:"production-deployment",level:2},{value:"Security Hardening",id:"security-hardening",level:3},{value:"Performance Tuning",id:"performance-tuning",level:3},{value:"CI/CD Integration",id:"cicd-integration",level:2},{value:"GitHub Actions Example",id:"github-actions-example",level:3},{value:"Monitoring",id:"monitoring",level:2},{value:"Prometheus + Grafana (Optional)",id:"prometheus--grafana-optional",level:3},{value:"Summary",id:"summary",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"docker-deployment",children:"Docker Deployment"})}),"\n",(0,o.jsx)(n.h2,{id:"t\u1ed5ng-quan",children:"T\u1ed5ng quan"}),"\n",(0,o.jsxs)(n.p,{children:["SmartCity-Platform s\u1eed d\u1ee5ng ",(0,o.jsx)(n.strong,{children:"Docker Compose"})," \u0111\u1ec3 tri\u1ec3n khai to\xe0n b\u1ed9 h\u1ec7 th\u1ed1ng v\u1edbi ",(0,o.jsx)(n.strong,{children:"single command deployment"}),". T\u1ea5t c\u1ea3 services \u0111\u01b0\u1ee3c containerized v\xe0 orchestrated th\xf4ng qua ",(0,o.jsx)(n.code,{children:"docker-compose.yml"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"ki\u1ebfn-tr\xfac-container",children:"Ki\u1ebfn tr\xfac Container"}),"\n",(0,o.jsx)(n.mermaid,{value:'graph TB\r\n    subgraph "Docker Network: smartcity-network"\r\n        subgraph "Edge Layer"\r\n            A[rabbitmq-edge-1<br/>Port: 5672, 15672]\r\n            B[rabbitmq-edge-2<br/>Port: 5673, 15673]\r\n        end\r\n        \r\n        subgraph "Storage Layer"\r\n            C[core-redis-hot<br/>Port: 6379]\r\n            D[core-mongo-warm<br/>Port: 27018]\r\n            E[core-mongo-cold<br/>Port: 27019]\r\n        end\r\n        \r\n        subgraph "Processing Layer"\r\n            F[smart-city-backend<br/>Port: 8080]\r\n            G[smart-city-ml<br/>Port: 8000]\r\n        end\r\n        \r\n        subgraph "Presentation Layer"\r\n            H[smart-city-frontend<br/>Port: 3000]\r\n        end\r\n    end\r\n    \r\n    F --\x3e A & B & C & D & E & G\r\n    H --\x3e F\r\n    \r\n    style F fill:#90EE90\r\n    style G fill:#FFB6C1\r\n    style H fill:#FFD700'}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsx)(n.h3,{id:"y\xeau-c\u1ea7u-h\u1ec7-th\u1ed1ng",children:"Y\xeau c\u1ea7u H\u1ec7 th\u1ed1ng"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Minimum:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Docker Engine 20.x+"}),"\n",(0,o.jsx)(n.li,{children:"Docker Compose 2.x+"}),"\n",(0,o.jsx)(n.li,{children:"RAM: 8GB"}),"\n",(0,o.jsx)(n.li,{children:"Disk: 20GB free space"}),"\n",(0,o.jsx)(n.li,{children:"CPU: 2 cores"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Recommended:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Docker Engine 24.x+"}),"\n",(0,o.jsx)(n.li,{children:"Docker Compose 2.20+"}),"\n",(0,o.jsx)(n.li,{children:"RAM: 16GB"}),"\n",(0,o.jsx)(n.li,{children:"Disk: 50GB SSD"}),"\n",(0,o.jsx)(n.li,{children:"CPU: 4+ cores"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"c\xe0i-\u0111\u1eb7t-docker",children:"C\xe0i \u0111\u1eb7t Docker"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Windows:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-powershell",children:"# Install Docker Desktop\r\n# Download from: https://www.docker.com/products/docker-desktop\r\n\r\n# Verify installation\r\ndocker --version\r\ndocker-compose --version\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Linux (Ubuntu/Debian):"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Install Docker\r\ncurl -fsSL https://get.docker.com -o get-docker.sh\r\nsudo sh get-docker.sh\r\n\r\n# Install Docker Compose\r\nsudo apt-get update\r\nsudo apt-get install docker-compose-plugin\r\n\r\n# Add user to docker group\r\nsudo usermod -aG docker $USER\r\nnewgrp docker\r\n\r\n# Verify\r\ndocker --version\r\ndocker compose version\n"})}),"\n",(0,o.jsx)(n.h2,{id:"docker-compose-configuration",children:"Docker Compose Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"file-structure",children:"File Structure"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"SmartCity-Platform/\r\n\u251c\u2500\u2500 docker-compose.yml         # Main orchestration file\r\n\u251c\u2500\u2500 backend/\r\n\u2502   \u251c\u2500\u2500 Dockerfile\r\n\u2502   \u2514\u2500\u2500 target/\r\n\u2502       \u2514\u2500\u2500 smart-city-backend.jar\r\n\u251c\u2500\u2500 ml-service/\r\n\u2502   \u251c\u2500\u2500 Dockerfile\r\n\u2502   \u251c\u2500\u2500 app/\r\n\u2502   \u2514\u2500\u2500 requirements.txt\r\n\u251c\u2500\u2500 frontend/\r\n\u2502   \u251c\u2500\u2500 Dockerfile\r\n\u2502   \u2514\u2500\u2500 .output/\r\n\u251c\u2500\u2500 python-data-simulator/\r\n\u2502   \u251c\u2500\u2500 Dockerfile\r\n\u2502   \u2514\u2500\u2500 simulator.py\r\n\u2514\u2500\u2500 .env                       # Environment variables (optional)\n"})}),"\n",(0,o.jsx)(n.h3,{id:"services-overview",children:"Services Overview"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Service"}),(0,o.jsx)(n.th,{children:"Image"}),(0,o.jsx)(n.th,{children:"Port(s)"}),(0,o.jsx)(n.th,{children:"Purpose"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"rabbitmq-edge-1"}),(0,o.jsx)(n.td,{children:"rabbitmq:3-management"}),(0,o.jsx)(n.td,{children:"5672, 15672"}),(0,o.jsx)(n.td,{children:"Message queue node 1"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"rabbitmq-edge-2"}),(0,o.jsx)(n.td,{children:"rabbitmq:3-management"}),(0,o.jsx)(n.td,{children:"5673, 15673"}),(0,o.jsx)(n.td,{children:"Message queue node 2"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"core-redis-hot"}),(0,o.jsxs)(n.td,{children:["redis",":alpine"]}),(0,o.jsx)(n.td,{children:"6379"}),(0,o.jsx)(n.td,{children:"HOT tier storage"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"core-mongo-warm"}),(0,o.jsx)(n.td,{children:"mongo:7.0"}),(0,o.jsx)(n.td,{children:"27018"}),(0,o.jsx)(n.td,{children:"WARM tier database"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"core-mongo-cold"}),(0,o.jsx)(n.td,{children:"mongo:7.0"}),(0,o.jsx)(n.td,{children:"27019"}),(0,o.jsx)(n.td,{children:"COLD tier database"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"smart-city-ml"}),(0,o.jsx)(n.td,{children:"custom"}),(0,o.jsx)(n.td,{children:"8000"}),(0,o.jsx)(n.td,{children:"ML classification service"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"smart-city-backend"}),(0,o.jsx)(n.td,{children:"custom"}),(0,o.jsx)(n.td,{children:"8080"}),(0,o.jsx)(n.td,{children:"Spring Boot backend"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"smart-city-frontend"}),(0,o.jsx)(n.td,{children:"custom"}),(0,o.jsx)(n.td,{children:"3000"}),(0,o.jsx)(n.td,{children:"NuxtJS frontend"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"deployment",children:"Deployment"}),"\n",(0,o.jsx)(n.h3,{id:"quick-start-one-command",children:"Quick Start (One Command)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Navigate to project root\r\ncd SmartCity-Platform\r\n\r\n# Start all services\r\ndocker-compose up -d\r\n\r\n# View logs\r\ndocker-compose logs -f\r\n\r\n# Check status\r\ndocker-compose ps\n"})}),"\n",(0,o.jsx)(n.h3,{id:"step-by-step-deployment",children:"Step-by-Step Deployment"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"1. Build Backend"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd backend\r\nmvn clean package -DskipTests\r\ncd ..\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"2. Build Frontend"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd frontend\r\nnpm install\r\nnpm run build\r\ncd ..\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"3. Start Infrastructure Services"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Start databases and message queues first\r\ndocker-compose up -d rabbitmq-edge-1 rabbitmq-edge-2\r\ndocker-compose up -d core-redis-hot core-mongo-warm core-mongo-cold\r\n\r\n# Wait for services to be healthy\r\nsleep 10\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"4. Start Application Services"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Start ML service\r\ndocker-compose up -d smart-city-ml\r\n\r\n# Wait for ML models to load\r\nsleep 5\r\n\r\n# Start backend\r\ndocker-compose up -d smart-city-backend\r\n\r\n# Wait for backend to be ready\r\nsleep 10\r\n\r\n# Start frontend\r\ndocker-compose up -d smart-city-frontend\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"5. Verify Deployment"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Check all services are running\r\ndocker-compose ps\r\n\r\n# Test endpoints\r\ncurl http://localhost:8080/actuator/health  # Backend\r\ncurl http://localhost:8000/health           # ML Service\r\ncurl http://localhost:3000                   # Frontend\n"})}),"\n",(0,o.jsx)(n.h2,{id:"service-configuration",children:"Service Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Backend (smart-city-backend):"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"environment:\r\n  - SPRING_PROFILES_ACTIVE=docker\r\n  - MONGODB_WARM_URI=mongodb://admin:password123@core-mongo-warm:27017/warm_db?authSource=admin\r\n  - MONGODB_COLD_URI=mongodb://admin:password123@core-mongo-cold:27017/cold_db?authSource=admin\r\n  - REDIS_HOST=core-redis-hot\r\n  - RABBITMQ_ADDRESSES=rabbitmq-edge-1:5672,rabbitmq-edge-2:5673\r\n  - ML_SERVICE_URL=http://smart-city-ml:8000\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"RabbitMQ:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"environment:\r\n  - RABBITMQ_DEFAULT_USER=edge_user\r\n  - RABBITMQ_DEFAULT_PASS=edge_pass\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MongoDB:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"environment:\r\n  - MONGO_INITDB_ROOT_USERNAME=admin\r\n  - MONGO_INITDB_ROOT_PASSWORD=password123\n"})}),"\n",(0,o.jsx)(n.h3,{id:"volume-mounting",children:"Volume Mounting"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Persistent Volumes:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"volumes:\r\n  rabbitmq_edge1_data:\r\n    driver: local\r\n  rabbitmq_edge2_data:\r\n    driver: local\r\n  redis_hot_data:\r\n    driver: local\r\n  mongo_warm_data:\r\n    driver: local\r\n  mongo_cold_data:\r\n    driver: local\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Mount Points:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["RabbitMQ: ",(0,o.jsx)(n.code,{children:"/var/lib/rabbitmq"})]}),"\n",(0,o.jsxs)(n.li,{children:["Redis: ",(0,o.jsx)(n.code,{children:"/data"})]}),"\n",(0,o.jsxs)(n.li,{children:["MongoDB: ",(0,o.jsx)(n.code,{children:"/data/db"})]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"networking",children:"Networking"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Bridge Network:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"networks:\r\n  smartcity-network:\r\n    driver: bridge\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Service Discovery:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Services communicate via container names (e.g., ",(0,o.jsx)(n.code,{children:"rabbitmq-edge-1"}),", ",(0,o.jsx)(n.code,{children:"core-redis-hot"}),")"]}),"\n",(0,o.jsx)(n.li,{children:"DNS resolution handled by Docker network"}),"\n",(0,o.jsx)(n.li,{children:"No need for IP addresses"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"container-management",children:"Container Management"}),"\n",(0,o.jsx)(n.h3,{id:"startstop-services",children:"Start/Stop Services"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Start all\r\ndocker-compose up -d\r\n\r\n# Start specific service\r\ndocker-compose up -d smart-city-backend\r\n\r\n# Stop all\r\ndocker-compose down\r\n\r\n# Stop but keep volumes\r\ndocker-compose stop\r\n\r\n# Restart service\r\ndocker-compose restart smart-city-backend\n"})}),"\n",(0,o.jsx)(n.h3,{id:"logs-v\xe0-monitoring",children:"Logs v\xe0 Monitoring"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# View all logs\r\ndocker-compose logs -f\r\n\r\n# View specific service logs\r\ndocker-compose logs -f smart-city-backend\r\n\r\n# Last 100 lines\r\ndocker-compose logs --tail=100 smart-city-ml\r\n\r\n# Follow logs from specific time\r\ndocker-compose logs --since 30m smart-city-frontend\n"})}),"\n",(0,o.jsx)(n.h3,{id:"resource-management",children:"Resource Management"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# View resource usage\r\ndocker stats\r\n\r\n# Limit resources in docker-compose.yml\r\nservices:\r\n  smart-city-backend:\r\n    deploy:\r\n      resources:\r\n        limits:\r\n          cpus: '2'\r\n          memory: 2G\r\n        reservations:\r\n          cpus: '1'\r\n          memory: 1G\n"})}),"\n",(0,o.jsx)(n.h3,{id:"health-checks",children:"Health Checks"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# Check container health\r\ndocker-compose ps\r\n\r\n# Detailed health status\r\ndocker inspect smart-city-backend | jq \'.[0].State.Health\'\r\n\r\n# Custom health check in docker-compose.yml\r\nservices:\r\n  smart-city-backend:\r\n    healthcheck:\r\n      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]\r\n      interval: 30s\r\n      timeout: 10s\r\n      retries: 3\r\n      start_period: 40s\n'})}),"\n",(0,o.jsx)(n.h2,{id:"data-management",children:"Data Management"}),"\n",(0,o.jsx)(n.h3,{id:"backup",children:"Backup"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MongoDB Backup:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Backup WARM database\r\ndocker exec core-mongo-warm mongodump \\\r\n  --username admin \\\r\n  --password password123 \\\r\n  --authenticationDatabase admin \\\r\n  --db warm_db \\\r\n  --out /backup\r\n\r\n# Copy backup from container\r\ndocker cp core-mongo-warm:/backup ./backup-warm\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Redis Backup:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Trigger Redis save\r\ndocker exec core-redis-hot redis-cli SAVE\r\n\r\n# Copy RDB file\r\ndocker cp core-redis-hot:/data/dump.rdb ./backup-redis/\n"})}),"\n",(0,o.jsx)(n.h3,{id:"restore",children:"Restore"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MongoDB Restore:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Copy backup to container\r\ndocker cp ./backup-warm core-mongo-warm:/backup\r\n\r\n# Restore\r\ndocker exec core-mongo-warm mongorestore \\\r\n  --username admin \\\r\n  --password password123 \\\r\n  --authenticationDatabase admin \\\r\n  --db warm_db \\\r\n  /backup/warm_db\n"})}),"\n",(0,o.jsx)(n.h3,{id:"reset-all-data",children:"Reset All Data"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# WARNING: Destructive operation!\r\n\r\n# Stop all services\r\ndocker-compose down\r\n\r\n# Remove all volumes\r\ndocker volume rm $(docker volume ls -q | grep smartcity)\r\n\r\n# Restart\r\ndocker-compose up -d\n"})}),"\n",(0,o.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,o.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"1. Port Already in Use"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Find process using port\r\nnetstat -ano | findstr :8080  # Windows\r\nlsof -i :8080                  # Linux/Mac\r\n\r\n# Kill process or change port in docker-compose.yml\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"2. Container Won't Start"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Check logs\r\ndocker-compose logs smart-city-backend\r\n\r\n# Check container status\r\ndocker inspect smart-city-backend\r\n\r\n# Force recreate\r\ndocker-compose up -d --force-recreate smart-city-backend\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"3. Network Issues"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Recreate network\r\ndocker-compose down\r\ndocker network prune\r\ndocker-compose up -d\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"4. Out of Disk Space"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Clean up\r\ndocker system prune -a --volumes\r\n\r\n# Check disk usage\r\ndocker system df\n"})}),"\n",(0,o.jsx)(n.h3,{id:"debug-mode",children:"Debug Mode"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Run in foreground with logs\r\ndocker-compose up\r\n\r\n# Run single service in debug mode\r\ndocker-compose run --rm smart-city-backend\r\n\r\n# Access container shell\r\ndocker exec -it smart-city-backend /bin/bash\r\ndocker exec -it core-mongo-warm mongosh\n"})}),"\n",(0,o.jsx)(n.h2,{id:"production-deployment",children:"Production Deployment"}),"\n",(0,o.jsx)(n.h3,{id:"security-hardening",children:"Security Hardening"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"1. Change Default Passwords"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# Use environment file\r\nenvironment:\r\n  - MONGO_INITDB_ROOT_PASSWORD=${'${MONGO_PASSWORD}'}\r\n  - RABBITMQ_DEFAULT_PASS=${'${RABBITMQ_PASSWORD}'}\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"2. Network Isolation"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# Separate networks for internal/external\r\nnetworks:\r\n  frontend-network:\r\n    driver: bridge\r\n  backend-network:\r\n    driver: bridge\r\n    internal: true\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"3. Resource Limits"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"# Set limits for all services\r\ndeploy:\r\n  resources:\r\n    limits:\r\n      memory: 2G\n"})}),"\n",(0,o.jsx)(n.h3,{id:"performance-tuning",children:"Performance Tuning"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"MongoDB:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"command: mongod --wiredTigerCacheSizeGB 2\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Redis:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"command: redis-server --maxmemory 512mb --maxmemory-policy allkeys-lru\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"RabbitMQ:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"environment:\r\n  - RABBITMQ_VM_MEMORY_HIGH_WATERMARK=2GB\n"})}),"\n",(0,o.jsx)(n.h2,{id:"cicd-integration",children:"CI/CD Integration"}),"\n",(0,o.jsx)(n.h3,{id:"github-actions-example",children:"GitHub Actions Example"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"name: Deploy to Production\r\n\r\non:\r\n  push:\r\n    branches: [ main ]\r\n\r\njobs:\r\n  deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - uses: actions/checkout@v3\r\n      \r\n      - name: Build and Deploy\r\n        run: |\r\n          docker-compose build\r\n          docker-compose up -d\r\n      \r\n      - name: Health Check\r\n        run: |\r\n          sleep 30\r\n          curl -f http://localhost:8080/actuator/health\n"})}),"\n",(0,o.jsx)(n.h2,{id:"monitoring",children:"Monitoring"}),"\n",(0,o.jsx)(n.h3,{id:"prometheus--grafana-optional",children:"Prometheus + Grafana (Optional)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'# Add to docker-compose.yml\r\nservices:\r\n  prometheus:\r\n    image: prom/prometheus\r\n    ports:\r\n      - "9090:9090"\r\n    volumes:\r\n      - ./prometheus.yml:/etc/prometheus/prometheus.yml\r\n  \r\n  grafana:\r\n    image: grafana/grafana\r\n    ports:\r\n      - "3001:3000"\n'})}),"\n",(0,o.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Quick Reference:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Deploy everything\r\ndocker-compose up -d\r\n\r\n# View status\r\ndocker-compose ps\r\n\r\n# View logs\r\ndocker-compose logs -f\r\n\r\n# Stop everything\r\ndocker-compose down\r\n\r\n# Clean up\r\ndocker-compose down -v\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Access Points:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Frontend: ",(0,o.jsx)(n.a,{href:"http://localhost:3000",children:"http://localhost:3000"})]}),"\n",(0,o.jsxs)(n.li,{children:["Backend API: ",(0,o.jsx)(n.a,{href:"http://localhost:8080",children:"http://localhost:8080"})]}),"\n",(0,o.jsxs)(n.li,{children:["ML Service: ",(0,o.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"})]}),"\n",(0,o.jsxs)(n.li,{children:["RabbitMQ Management: ",(0,o.jsx)(n.a,{href:"http://localhost:15672",children:"http://localhost:15672"})," (edge_user / edge_pass)"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);